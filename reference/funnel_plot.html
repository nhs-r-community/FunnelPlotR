<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Funnel plots for comparing institutional performance ‚Äî funnel_plot ‚Ä¢ FunnelPlotR</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Funnel plots for comparing institutional performance ‚Äî funnel_plot"><meta property="og:description" content="An implementation of funnel plots for indirectly standardised ratios, as described by Spiegelhalter (2005) &amp;lt;https://doi.org/10.1002/sim.1970/&amp;gt;.
There are several parameters for the input, with the assumption that you will want smooth,
overdispersed, funnel control limits.  Limits may be inflated for overdispersion based on the methods of DerSimonian &amp;amp; Laird (1986), buy calculating a between unit standard deviation (\(\tau\))
and constructing an additive random effects models, originally used for meta-analyses of clinical trials data."><meta property="og:image" content="https://nhs-r-community.github.io/FunnelPlotR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-146859070-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146859070-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FunnelPlotR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/funnel_plots.html">Introduction to Funnel Plots</a>
    </li>
    <li>
      <a href="../articles/changing_funnel_plot_options.html">Changing funnel plot options</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nhs-r-community/FunnelPlotR" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Funnel plots for comparing institutional performance</h1>
    <small class="dont-index">Source: <a href="https://github.com/nhs-r-community/FunnelPlotR/blob/main/R/funnel_plot.R" class="external-link"><code>R/funnel_plot.R</code></a></small>
    <div class="hidden name"><code>funnel_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An implementation of funnel plots for indirectly standardised ratios, as described by Spiegelhalter (2005) &lt;https://doi.org/10.1002/sim.1970/&gt;.
There are several parameters for the input, with the assumption that you will want smooth,
overdispersed, funnel control limits.  Limits may be inflated for overdispersion based on the methods of DerSimonian &amp; Laird (1986), buy calculating a between unit standard deviation (\(\tau\))
and constructing an additive random effects models, originally used for meta-analyses of clinical trials data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">funnel_plot</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"SR"</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"outlier"</span>,</span>
<span>  highlight <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  draw_unadjusted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  draw_adjusted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sr_method <span class="op">=</span> <span class="st">"SHMI"</span>,</span>
<span>  trim_by <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Untitled Funnel Plot"</span>,</span>
<span>  multiplier <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  x_label <span class="op">=</span> <span class="st">"Expected"</span>,</span>
<span>  <span class="va">y_label</span>,</span>
<span>  x_range <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  y_range <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  plot_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FF7F0EFF"</span>, <span class="st">"#1F77B4FF"</span>, <span class="st">"#9467BDFF"</span>, <span class="st">"#2CA02CFF"</span><span class="op">)</span>,</span>
<span>  theme <span class="op">=</span> <span class="fu"><a href="funnel_clean.html">funnel_clean</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">label_outliers</span>,</span>
<span>  <span class="va">Poisson_limits</span>,</span>
<span>  <span class="va">OD_adjust</span>,</span>
<span>  <span class="va">xrange</span>,</span>
<span>  <span class="va">yrange</span>,</span>
<span>  SHMI_rounding <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max.overlaps <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing a numerator, denominator and grouping field.</p></dd>


<dt id="arg-numerator">numerator<a class="anchor" aria-label="anchor" href="#arg-numerator"></a></dt>
<dd><p>A vector of the numerator (observed events/counts) values.  Used as numerator of the Y-axis</p></dd>


<dt id="arg-denominator">denominator<a class="anchor" aria-label="anchor" href="#arg-denominator"></a></dt>
<dd><p>A vector of denominator (predicted/population etc.)  Used as denominator of the Y-axis and the scale of the x-axis</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A vector of group names as character or factor.  Used to aggregate and group points on plots</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>A string identifying the type of data used for in the plot, the adjustment used and the reference point. One of: "SR" for indirectly standardised ratios, such SHMI, "PR" for proportions, or "RC" for ratios of counts. Default is "SR".</p></dd>


<dt id="arg-limit">limit<a class="anchor" aria-label="anchor" href="#arg-limit"></a></dt>
<dd><p>Plot limits, accepted values are: 95 or 99, corresponding to 95% or 99.8% quantiles of the distribution. Default=99,and applies to OD limits if both OD and Poisson are used.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>Whether to label outliers, highlighted groups, both or none. Default is "outlier", by accepted values are:<br></p><ul><li><p><code>"outlier"</code> - Labels upper and lower outliers, determined in relation to the `limit` argument.</p></li>
<li><p><code>"outlier_lower"</code> - Labels just and lower outliers, determined in relation to the `limit` argument.</p></li>
<li><p><code>"outlier_upper"</code> - Labels just upper, determined in relation to the `limit` argument.</p></li>
<li><p><code>"highlight"</code> - Labels the value(s) given in the `highlight`argument.</p></li>
<li><p><code>"both"</code> - Labels both the highlighted values(s), upper and lower outliers, determined in relation to the `limit` argument.</p></li>
<li><p><code>"both_lower"</code> - Labels both the highlighted values(s) and lower outliers, determined in relation to the `limit` argument.</p></li>
<li><p><code>"both_upper"</code> - Labels both the highlighted values(s) and upper outliers, determined in relation to the `limit` argument.</p></li>
<li><p><code>NA</code> - No labels applied</p></li>
</ul></dd>


<dt id="arg-highlight">highlight<a class="anchor" aria-label="anchor" href="#arg-highlight"></a></dt>
<dd><p>Single or vector of points to highlight, with a different colour and point style. Should correspond to values specified to `group`. Default is NA, for no highlighting.</p></dd>


<dt id="arg-draw-unadjusted">draw_unadjusted<a class="anchor" aria-label="anchor" href="#arg-draw-unadjusted"></a></dt>
<dd><p>Draw control limits without overdispersion adjustment. (default=FALSE)</p></dd>


<dt id="arg-draw-adjusted">draw_adjusted<a class="anchor" aria-label="anchor" href="#arg-draw-adjusted"></a></dt>
<dd><p>Draw overdispersed limits using hierarchical model, assuming at group level, as described in Spiegelhalter (2012).
It calculates a second variance component ' for the 'between' standard deviation (\(\tau\)), that is added to the 'within' standard deviation (sigma) (default=TRUE)</p></dd>


<dt id="arg-sr-method">sr_method<a class="anchor" aria-label="anchor" href="#arg-sr-method"></a></dt>
<dd><p>Method for adjustment when using indirectly standardised ratios (type="SR") Either "CQC" or "SHMI" (default). There are a few methods for standardisation.  "CQC"/Spiegelhalter
uses a square-root transformation and Winsorises (rescales the outer most values to a particular percentile).
SHMI, instead, uses log-transformation and doesn't Winsorise, but truncates the distribution before assessing overdisperison .
Both methods then calculate a dispersion ratio (\(\phi\)) on this altered dataset.  This ratio is then used to scale the full dataset,
and the plot is drawn for the full dataset.</p></dd>


<dt id="arg-trim-by">trim_by<a class="anchor" aria-label="anchor" href="#arg-trim-by"></a></dt>
<dd><p>Proportion of the distribution for winsorisation/truncation. Default is 10 % (0.1).  Note, this is applied in a two-sided
fashion, e.g. 10% refers to 10% at each end of the distribution (20% winsorised/truncated)</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Plot title</p></dd>


<dt id="arg-multiplier">multiplier<a class="anchor" aria-label="anchor" href="#arg-multiplier"></a></dt>
<dd><p>Scale relative risk and funnel by this factor. Default to 1, but 100 sometime used, e.g. in some hospital mortality ratios.</p></dd>


<dt id="arg-x-label">x_label<a class="anchor" aria-label="anchor" href="#arg-x-label"></a></dt>
<dd><p>Title for the funnel plot x-axis.  Usually expected deaths, readmissions, incidents etc.</p></dd>


<dt id="arg-y-label">y_label<a class="anchor" aria-label="anchor" href="#arg-y-label"></a></dt>
<dd><p>Title for the funnel plot y-axis.  Usually a standardised ratio.</p></dd>


<dt id="arg-x-range">x_range<a class="anchor" aria-label="anchor" href="#arg-x-range"></a></dt>
<dd><p>Manually specify the y-axis min and max, in form c(min, max), e.g. c(0, 200). Default, "auto", allows function to estimate range.</p></dd>


<dt id="arg-y-range">y_range<a class="anchor" aria-label="anchor" href="#arg-y-range"></a></dt>
<dd><p>Manually specify the y-axis min and max, in form c(min, max), e.g. c(0.7, 1.3). Default, "auto", allows function to estimate range.</p></dd>


<dt id="arg-plot-cols">plot_cols<a class="anchor" aria-label="anchor" href="#arg-plot-cols"></a></dt>
<dd><p>A vector of 4 colours for funnel limits, in order: 95% Poisson (lower/upper), 99.8% Poisson (lower/upper), 95% OD-adjusted (lower/upper), 99.8% OD-adjusted (lower/upper).
Default has been chosen to avoid red and green which can lead to subconscious value judgements of good or bad.
Default is hex colours: c("#FF7F0EFF", "#1F77B4FF", "#9467BDFF", "#2CA02CFF")</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>a ggplot theme function.  This can be a canned theme such as theme_bw(), a theme() with arguments, or your own custom theme function. Default is new funnel_clean(), but funnel_classic() is original format.</p></dd>


<dt id="arg-label-outliers">label_outliers<a class="anchor" aria-label="anchor" href="#arg-label-outliers"></a></dt>
<dd><p>Deprecated.  Please use the `label` argument instead.</p></dd>


<dt id="arg-poisson-limits">Poisson_limits<a class="anchor" aria-label="anchor" href="#arg-poisson-limits"></a></dt>
<dd><p>Deprecated.  Please use the `draw_unadjusted` argument instead.</p></dd>


<dt id="arg-od-adjust">OD_adjust<a class="anchor" aria-label="anchor" href="#arg-od-adjust"></a></dt>
<dd><p>Deprecated.  Please use the `draw_adjusted` argument instead.</p></dd>


<dt id="arg-xrange">xrange<a class="anchor" aria-label="anchor" href="#arg-xrange"></a></dt>
<dd><p>Deprecated.  Please use the `x_range` argument instead.</p></dd>


<dt id="arg-yrange">yrange<a class="anchor" aria-label="anchor" href="#arg-yrange"></a></dt>
<dd><p>Deprecated.  Please use the `y_range` argument instead.</p></dd>


<dt id="arg-shmi-rounding">SHMI_rounding<a class="anchor" aria-label="anchor" href="#arg-shmi-rounding"></a></dt>
<dd><p>TRUE/FALSE, for SHMI calculation (standardised ratio, with SHMI truncation etc.), should you round the expected values to 2 decimal places (TRUE) or not (FALSE)</p></dd>


<dt id="arg-max-overlaps">max.overlaps<a class="anchor" aria-label="anchor" href="#arg-max-overlaps"></a></dt>
<dd><p>Exclude text labels that overlap too many things. Defaults to 10. (inherited from geom_label_repel)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A fitted `funnelplot` object.  A `funnelplot` object is a list containing the following components:<br></p>
<dl><dt>print</dt>
<dd><p>Prints the number of points, outliers and whether the plot has been adjusted, and prints the plot</p></dd>

<dt>plot</dt>
<dd><p>A ggplot object with the funnel plot and the appropriate limits</p></dd>

<dt>limits_lookup</dt>
<dd><p>A lookup table with selected limits for drawing a plot in software that requires limits.</p></dd>

<dt>aggregated_data</dt>
<dd><p>A data.frame of the the aggregated dataset used for the plot.</p></dd>

<dt>outlier</dt>
<dd><p>A data frame of outliers from the data.</p></dd>

<dt>tau2</dt>
<dd><p>The between-groups standard deviation, \(\tau^2\).</p></dd>

<dt>phi</dt>
<dd><p>The dispersion ratio, \(\phi\).</p></dd>

<dt>draw_adjusted</dt>
<dd><p>Whether overdispersion-adjusted limits were used.</p></dd>

<dt>draw_unadjusted</dt>
<dd><p>Whether unadjusted Poisson limits were used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Outliers are marked based on the grouping, and the limits chosen, corresponding to either 95% or 99.8% quantiles of the normal distribution.<br>
   Labels can attached using the `label` argument.<br>
   Overdispersion can be factored in based on the methods in Spiegelhalter et al. (2012), set `draw_adjusted` to FALSE to suppress this. <br>
   To use Poisson limits set `draw_unadjusted=TRUE`. <br>
   The plot colours deliberately avoid red-amber-green colouring, but you could extract this from the ggplot object and change manually if you like.
   Future versions of `funnelplotr` may allow users to change this.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>DerSimonian &amp; Laird (1986)  Meta-analysis in clinical trials. &lt;doi:10.1016/0197-2456(86)90046-2&gt;</p>
<p>Spiegelhalter (2005) Funnel plots for comparing institutional performance  &lt;doi:10.1002/sim.1970&gt;</p>
<p>Spiegelhalter et al. (2012) Statistical methods for healthcare regulation: rating, screening and surveillance: &lt;doi:10.1111/j.1467-985X.2011.01010.x&gt;</p>
<p>NHS Digital (2020) SHMI Methodology v .134 <a href="https://digital.nhs.uk/data-and-information/publications/ci-hub/summary-hospital-level-mortality-indicator-shmi" class="external-link">https://digital.nhs.uk/data-and-information/publications/ci-hub/summary-hospital-level-mortality-indicator-shmi</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># We will use the 'medpar' dataset from the 'COUNT' package.</span></span></span>
<span class="r-in"><span><span class="co"># Little reformatting needed</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">COUNT</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: msme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MASS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: lattice</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sandwich</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">medpar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">medpar</span><span class="op">$</span><span class="va">provnum</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">medpar</span><span class="op">$</span><span class="va">provnum</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">medpar</span><span class="op">$</span><span class="va">los</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">medpar</span><span class="op">$</span><span class="va">los</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">los</span> <span class="op">~</span> <span class="va">hmo</span> <span class="op">+</span> <span class="va">died</span> <span class="op">+</span> <span class="va">age80</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span></span></span>
<span class="r-in"><span>      , family<span class="op">=</span><span class="st">"poisson"</span>, data<span class="op">=</span><span class="va">medpar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get predicted values for building ratio</span></span></span>
<span class="r-in"><span><span class="va">medpar</span><span class="op">$</span><span class="va">prds</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Draw plot, returning just the plot object</span></span></span>
<span class="r-in"><span><span class="va">fp</span><span class="op">&lt;-</span><span class="fu">funnel_plot</span><span class="op">(</span><span class="va">medpar</span>, denominator<span class="op">=</span><span class="va">prds</span>, numerator<span class="op">=</span><span class="va">los</span>,</span></span>
<span class="r-in"><span>group <span class="op">=</span> <span class="va">provnum</span>, limit<span class="op">=</span><span class="fl">95</span>, title<span class="op">=</span><span class="st">"An example funnel plot"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Methods for viewing/extracting</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="funnel_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A funnel plot object with 54 points of which 16 are outliers. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plot is adjusted for overdispersion. </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="funnel_plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A funnel plot object with 54 points of which 16 are outliers. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion ratio: œï = 8.532851 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plot is adjusted for overdispersion. Between unit variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ùúè¬≤, = 0.02841023 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outliers: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    denominator  group numerator        rr target_transformed          Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      120.94 030007        82 0.6780368                  0 -0.3885753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28      245.61 030017       131 0.5333603                  0 -0.6285476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        28.80 030025        14 0.4861594                  0 -0.7213181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       73.21 030035        37 0.5054258                  0 -0.6824141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32      273.34 030037       145 0.5304793                  0 -0.6339827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      172.38 030043       104 0.6033232                  0 -0.5053104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        19.20 030044         6 0.3125609                  0 -1.1631508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        19.96 030060         7 0.3506260                  0 -1.0478201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      198.94 030062       134 0.6735680                  0 -0.3951635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       45.87 030067        22 0.4796652                  0 -0.7347689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         9.67 030068         2 0.2068827                  0 -1.5758811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       38.92 030073        87 2.2352298                  0  0.8043999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        31.74 030078        55 1.7329455                  0  0.5497555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52      685.59 032000      1012 1.4761101                  0  0.3894041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      181.11 032002       283 1.5626043                  0  0.4463423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        24.81 032003        95 3.8296445                  0  1.3426301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Uzscore rk sp truncated  Wuzscore          s   OD95LCL  OD95UCL   OD99LCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  -4.273269 13  2         0 -4.273269 0.09093164 0.6870374 1.455525 0.5533126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  -9.850566  2  0         1        NA 0.06380827 0.7024099 1.423670 0.5729580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -3.870999 16  2         0 -3.870999 0.18633900 0.6111188 1.636343 0.4600330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  -5.838929  4  0         1        NA 0.11687316 0.6689770 1.494820 0.5305541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 -10.481634  1  0         1        NA 0.06048510 0.7039943 1.420466 0.5749970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  -6.634401  3  0         1        NA 0.07616520 0.6959196 1.436948 0.5646331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -5.096671  8  1         0 -5.096671 0.22821773 0.5734589 1.743804 0.4161366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -4.681306 12  2         0 -4.681306 0.22383074 0.5774252 1.731826 0.4206837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  -5.573626  7  1         0 -5.573626 0.07089881 0.6987976 1.431030 0.5683191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  -4.976398  9  1         0 -4.976398 0.14765074 0.6445616 1.551442 0.5003471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -4.900458 10  1         0 -4.900458 0.32157832 0.4908522 2.037273 0.3256333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   5.018321 50  9         1        NA 0.16029264 0.6338819 1.577581 0.4873387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    3.097227 48  8         0  3.097227 0.17749926 0.6189345 1.615680 0.4693434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  10.196068 54  9         1        NA 0.03819159 0.7126729 1.403168 0.5862128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   6.006746 51  9         1        NA 0.07430684 0.6969535 1.434816 0.5659563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    6.687592 53  9         1        NA 0.20076436 0.5982289 1.671601 0.4448276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     OD99UCL     LCL95    UCL95     LCL99    UCL99 highlight outlier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 1.807297 0.8297333 1.194925 0.7423709 1.314130         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 1.745329 0.8788379 1.133198 0.8143570 1.213308         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2.173757 0.6686912 1.437947 0.5211690 1.720387         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1.884822 0.7841313 1.256939 0.6773325 1.416488         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 1.739139 0.8849536 1.125850 0.8234590 1.201382         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1.771061 0.8562871 1.160931 0.7810534 1.258467         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2.403057 0.6038663 1.558062 0.4393444 1.925512         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2.377083 0.6104869 1.545079 0.4474921 1.903227         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 1.759575 0.8658614 1.149033 0.7951428 1.239064         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1.998612 0.7317770 1.334400 0.6049421 1.545676         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  3.070939 0.4725050 1.857410 0.2885378 2.445625         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2.051961 0.7108273 1.367468 0.5766906 1.601235         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2.130636 0.6828360 1.413670 0.5396094 1.679236         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 1.705865 0.9265368 1.077739 0.8861228 1.123734         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 1.766921 0.8596594 1.156719 0.7860075 1.251593         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2.248062 0.6459532 1.478364 0.4919575 1.789136         0       1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="limits.html">limits</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number.seq         s    odll95   odul95    odll998   odul998       ll95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1.100000 0.9534626 0.1499088 6.670722 0.05018164 19.927608 0.03371131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1.951752 0.7157934 0.2366198 4.226189 0.10305763  9.703309 0.11649266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   2.803504 0.5972408 0.2963262 3.374659 0.14694390  6.805318 0.19111654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   3.655255 0.5230475 0.3405923 2.936062 0.18301425  5.464055 0.25146337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4.507007 0.4710379 0.3751069 2.665907 0.21309812  4.692674 0.30040779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   5.358759 0.4319842 0.4029908 2.481446 0.23860393  4.191046 0.34084501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ul95       ll998    ul998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 5.221912 0.001776962 8.584873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.662330 0.021035676 5.706165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.021377 0.054943422 4.534074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.664519 0.092282260 3.886543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2.433992 0.128280000 3.470972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2.271243 0.161498083 3.179229</span>
<span class="r-in"><span><span class="fu"><a href="outliers.html">outliers</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    denominator  group numerator        rr target_transformed          Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      120.94 030007        82 0.6780368                  0 -0.3885753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28      245.61 030017       131 0.5333603                  0 -0.6285476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        28.80 030025        14 0.4861594                  0 -0.7213181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       73.21 030035        37 0.5054258                  0 -0.6824141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32      273.34 030037       145 0.5304793                  0 -0.6339827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      172.38 030043       104 0.6033232                  0 -0.5053104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        19.20 030044         6 0.3125609                  0 -1.1631508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        19.96 030060         7 0.3506260                  0 -1.0478201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      198.94 030062       134 0.6735680                  0 -0.3951635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       45.87 030067        22 0.4796652                  0 -0.7347689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         9.67 030068         2 0.2068827                  0 -1.5758811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       38.92 030073        87 2.2352298                  0  0.8043999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        31.74 030078        55 1.7329455                  0  0.5497555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52      685.59 032000      1012 1.4761101                  0  0.3894041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      181.11 032002       283 1.5626043                  0  0.4463423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        24.81 032003        95 3.8296445                  0  1.3426301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Uzscore rk sp truncated  Wuzscore          s   OD95LCL  OD95UCL   OD99LCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  -4.273269 13  2         0 -4.273269 0.09093164 0.6870374 1.455525 0.5533126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  -9.850566  2  0         1        NA 0.06380827 0.7024099 1.423670 0.5729580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -3.870999 16  2         0 -3.870999 0.18633900 0.6111188 1.636343 0.4600330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  -5.838929  4  0         1        NA 0.11687316 0.6689770 1.494820 0.5305541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 -10.481634  1  0         1        NA 0.06048510 0.7039943 1.420466 0.5749970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  -6.634401  3  0         1        NA 0.07616520 0.6959196 1.436948 0.5646331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   -5.096671  8  1         0 -5.096671 0.22821773 0.5734589 1.743804 0.4161366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   -4.681306 12  2         0 -4.681306 0.22383074 0.5774252 1.731826 0.4206837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  -5.573626  7  1         0 -5.573626 0.07089881 0.6987976 1.431030 0.5683191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  -4.976398  9  1         0 -4.976398 0.14765074 0.6445616 1.551442 0.5003471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   -4.900458 10  1         0 -4.900458 0.32157832 0.4908522 2.037273 0.3256333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   5.018321 50  9         1        NA 0.16029264 0.6338819 1.577581 0.4873387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    3.097227 48  8         0  3.097227 0.17749926 0.6189345 1.615680 0.4693434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  10.196068 54  9         1        NA 0.03819159 0.7126729 1.403168 0.5862128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   6.006746 51  9         1        NA 0.07430684 0.6969535 1.434816 0.5659563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    6.687592 53  9         1        NA 0.20076436 0.5982289 1.671601 0.4448276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     OD99UCL     LCL95    UCL95     LCL99    UCL99 highlight outlier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 1.807297 0.8297333 1.194925 0.7423709 1.314130         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 1.745329 0.8788379 1.133198 0.8143570 1.213308         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2.173757 0.6686912 1.437947 0.5211690 1.720387         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 1.884822 0.7841313 1.256939 0.6773325 1.416488         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 1.739139 0.8849536 1.125850 0.8234590 1.201382         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 1.771061 0.8562871 1.160931 0.7810534 1.258467         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2.403057 0.6038663 1.558062 0.4393444 1.925512         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2.377083 0.6104869 1.545079 0.4474921 1.903227         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 1.759575 0.8658614 1.149033 0.7951428 1.239064         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1.998612 0.7317770 1.334400 0.6049421 1.545676         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  3.070939 0.4725050 1.857410 0.2885378 2.445625         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2.051961 0.7108273 1.367468 0.5766906 1.601235         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2.130636 0.6828360 1.413670 0.5396094 1.679236         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 1.705865 0.9265368 1.077739 0.8861228 1.123734         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 1.766921 0.8596594 1.156719 0.7860075 1.251593         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2.248062 0.6459532 1.478364 0.4919575 1.789136         0       1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="source_data.html">source_data</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    denominator  group numerator        rr target_transformed             Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46      523.70 030001       406 0.7752585                  0 -0.2545658417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48      612.98 030002       642 1.0473450                  0  0.0462559947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13       53.79 030003        46 0.8551559                  0 -0.1564461798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53      763.72 030006       764 1.0003694                  0  0.0003665593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      120.94 030007        82 0.6780368                  0 -0.3885753076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29      250.19 030008       201 0.8034022                  0 -0.2189157211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Uzscore rk sp truncated    Wuzscore          s   OD95LCL  OD95UCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 -5.82561011  5  0         1          NA 0.04369771 0.7108599 1.406747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  1.14522594 37  6         0  1.14522594 0.04039028 0.7119760 1.404542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 -1.14740235 25  4         0 -1.14740235 0.13634814 0.6538255 1.529460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  0.01013004 31  5         0  0.01013004 0.03618536 0.7132769 1.401980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 -4.27326850 13  2         0 -4.27326850 0.09093164 0.6870374 1.455525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 -3.46267654 18  3         0 -3.46267654 0.06322153 0.7026948 1.423093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      OD99LCL  OD99UCL     LCL95    UCL95     LCL99    UCL99 highlight outlier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 0.5838633 1.712730 0.9161767 1.089431 0.8703859 1.142533         0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 0.5853093 1.708499 0.9223928 1.082393 0.8798183 1.131211         0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.5117322 1.954147 0.7507815 1.305456 0.6309291 1.497241         0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 0.5869963 1.703588 0.9303262 1.073510 0.8918993 1.116945         0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.5533126 1.807297 0.8297333 1.194925 0.7423709 1.314130         0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.5733244 1.744213 0.8799161 1.131898 0.8159596 1.211196         0       0</span>
<span class="r-in"><span><span class="fu"><a href="phi.html">phi</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.532851</span>
<span class="r-in"><span><span class="fu"><a href="tau2.html">tau2</a></span><span class="op">(</span><span class="va">fp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02841023</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.mainard.co.uk" class="external-link">Chris Mainey</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

